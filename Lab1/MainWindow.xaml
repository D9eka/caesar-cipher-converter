<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Lab1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Lab1"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Шифр Цезаря">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid x:Name="mainGrid" Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="inputColumn" Width="*" />
            <ColumnDefinition x:Name="outputColumn" Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition x:Name="inputRow" Height="Auto" />
            <RowDefinition x:Name="outputRow" Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.Resources>
            <Style x:Key="PrimaryButton" TargetType="Button">
                <Setter Property="Background" Value="#0078D4" />
                <Setter Property="Foreground" Value="White" />
                <Setter Property="CornerRadius" Value="5" />
                <Setter Property="Padding" Value="10,5" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="Margin" Value="0,0,0,10" />
            </Style>
            <Style x:Key="HeaderText" TargetType="TextBlock">
                <Setter Property="FontSize" Value="20" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="Margin" Value="0,0,0,10" />
            </Style>
            <Style x:Key="AdaptiveTextBox" TargetType="TextBox">
                <Setter Property="AcceptsReturn" Value="True" />
                <Setter Property="TextWrapping" Value="Wrap" />
                <Setter Property="MinHeight" Value="100" />
                <Setter Property="MaxHeight" Value="300" />
                <Setter Property="Margin" Value="0,0,0,10" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
            </Style>
            <Style x:Key="AdaptiveComboBox" TargetType="ComboBox">
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="Margin" Value="0,0,0,10" />
            </Style>
        </Grid.Resources>

        <!-- InputPanel -->
        <StackPanel x:Name="inputPanel" Grid.Column="0" Grid.Row="0" Margin="0,0,10,0">
            <TextBlock Text="Введите текст" Style="{StaticResource HeaderText}" />
            <TextBox x:Name="inputTextBox" 
                     PlaceholderText="Введите ваш текст" 
                     Style="{StaticResource AdaptiveTextBox}" 
                     Text="{Binding InputText, Mode=TwoWay}" />

            <Button Content="Вставить" 
                    Style="{StaticResource PrimaryButton}" 
                    Grid.Column="0" 
                    Margin="0,0,5,0" 
                    Command="{Binding PasteCommand}"
                    Click="PasteButton_Click" />

            <!-- ComboBoxes -->
            <StackPanel x:Name="comboBoxesContainer" Margin="0,0,0,10" Orientation="Vertical">
                <ComboBox x:Name="alphabetComboBox" Header="Выбранный алфавит" Style="{StaticResource AdaptiveComboBox}" 
                          ItemsSource="{Binding Alphabets}" 
                          SelectedItem="{Binding SelectedAlphabet, Mode=TwoWay}"
                          SelectionChanged="AlphabetComboBox_SelectionChanged"
                          Visibility="{Binding AlphabetComboBoxVisibility}" />
                <ComboBox x:Name="operationComboBox" Header="Тип операции" Style="{StaticResource AdaptiveComboBox}" 
                          ItemsSource="{Binding Operations}" 
                          SelectedItem="{Binding SelectedOperation, Mode=TwoWay}"
                          SelectionChanged="OperationComboBox_SelectionChanged"
                          Visibility="{Binding OperationComboBoxVisibility}" />
                <ComboBox x:Name="shiftComboBox" Header="Сдвиг" Style="{StaticResource AdaptiveComboBox}" 
                          ItemsSource="{Binding Shifts}" 
                          SelectedItem="{Binding SelectedShift, Mode=TwoWay}"
                          SelectionChanged="ShiftComboBox_SelectionChanged"
                          Visibility="{Binding ShiftVisibility}" />
            </StackPanel>

            <Button Content="Рассчитать" 
                    Style="{StaticResource PrimaryButton}" 
                    Grid.Column="1" 
                    Margin="5,0,0,0" 
                    Command="{Binding CalculateCommand}"
                    Click="CalculateButton_Click" />
        </StackPanel>

        <!-- OutputPanel -->
        <StackPanel x:Name="outputPanel" Grid.Column="1" Grid.Row="0" Margin="10,0,0,0" Visibility="{Binding OutputVisibility}">
            <TextBlock Text="Результат" Style="{StaticResource HeaderText}" />
            <TextBox x:Name="resultTextBox" 
                     Style="{StaticResource AdaptiveTextBox}" 
                     IsReadOnly="True" 
                     Text="{Binding OutputText}" />
            <Button Content="Копировать" 
                    Style="{StaticResource PrimaryButton}" 
                    Command="{Binding CopyCommand}"
                    Click="CopyButton_Click" />
        </StackPanel>

        <!-- Visual states -->
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="layoutStates">

                <!-- 1) Узкий (Min=0) -->
                <VisualState x:Name="narrowLayout">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="inputColumn.Width" Value="*" />
                        <Setter Target="outputColumn.Width" Value="0" />

                        <Setter Target="inputRow.Height" Value="Auto" />
                        <Setter Target="outputRow.Height" Value="Auto" />

                        <Setter Target="inputPanel.(Grid.Column)" Value="0" />
                        <Setter Target="inputPanel.(Grid.Row)" Value="0" />

                        <Setter Target="outputPanel.(Grid.Column)" Value="0" />
                        <Setter Target="outputPanel.(Grid.Row)" Value="1" />

                        <Setter Target="comboBoxesContainer.Orientation" Value="Vertical" />
                        <Setter Target="alphabetComboBox.Margin" Value="0,0,0,10" />
                        <Setter Target="operationComboBox.Margin" Value="0,0,0,10" />
                        <Setter Target="shiftComboBox.Margin" Value="0,0,0,10" />
                    </VisualState.Setters>
                </VisualState>

                <!-- 2) Средний (Min=600) -->
                <VisualState x:Name="mediumLayout">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="600" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="inputColumn.Width" Value="*" />
                        <Setter Target="outputColumn.Width" Value="0" />

                        <Setter Target="inputRow.Height" Value="Auto" />
                        <Setter Target="outputRow.Height" Value="Auto" />

                        <Setter Target="inputPanel.(Grid.Column)" Value="0" />
                        <Setter Target="inputPanel.(Grid.Row)" Value="0" />

                        <Setter Target="outputPanel.(Grid.Column)" Value="0" />
                        <Setter Target="outputPanel.(Grid.Row)" Value="1" />

                        <Setter Target="comboBoxesContainer.Orientation" Value="Horizontal" />
                        <Setter Target="alphabetComboBox.Margin" Value="0,0,10,0" />
                        <Setter Target="operationComboBox.Margin" Value="0,0,10,0" />
                        <Setter Target="shiftComboBox.Margin" Value="0,0,0,0" />
                    </VisualState.Setters>
                </VisualState>

                <!-- 3) Широкий (Min=1000) -->
                <VisualState x:Name="wideLayout">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1000" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="inputColumn.Width" Value="*" />
                        <Setter Target="outputColumn.Width" Value="*" />

                        <Setter Target="inputRow.Height" Value="*" />
                        <Setter Target="outputRow.Height" Value="0" />

                        <Setter Target="inputPanel.(Grid.Column)" Value="0" />
                        <Setter Target="inputPanel.(Grid.Row)" Value="0" />

                        <Setter Target="outputPanel.(Grid.Column)" Value="1" />
                        <Setter Target="outputPanel.(Grid.Row)" Value="0" />

                        <Setter Target="comboBoxesContainer.Orientation" Value="Horizontal" />
                        <Setter Target="alphabetComboBox.Margin" Value="0,0,10,0" />
                        <Setter Target="operationComboBox.Margin" Value="0,0,10,0" />
                        <Setter Target="shiftComboBox.Margin" Value="0,0,0,0" />
                    </VisualState.Setters>
                </VisualState>

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Window>
